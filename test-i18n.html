<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test I18n</title>
  <style>
    body {
      font-family: system-ui;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin: 10px;
    }
    .test-section {
      background: #f5f5f5;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>Test du système I18n</h1>
  
  <div class="test-section">
    <h2>Contrôles</h2>
    <button id="lang-toggle">Changer langue</button>
    <button onclick="checkSystem()">Vérifier le système</button>
  </div>

  <div class="test-section">
    <h2>Textes traduits</h2>
    <p data-i18n="nav.vision">Vision</p>
    <p data-i18n="nav.tech">Tech</p>
    <p data-i18n="hero.title">IAS Glass</p>
    <p data-i18n="hero.subtitle">Les premières lunettes IA totalement autonomes</p>
  </div>

  <div class="test-section">
    <h2>Console de debug</h2>
    <div id="debug-console" style="background: #fff; padding: 10px; font-family: monospace; min-height: 200px;"></div>
  </div>

  <script src="assets/js/translations.js?v=1.0"></script>
  <script>
    const debugLog = (msg) => {
      const debugConsole = document.getElementById('debug-console');
      debugConsole.innerHTML += msg + '<br>';
      console.log(msg);
    };

    function checkSystem() {
      debugLog('--- Vérification du système ---');
      debugLog('window.translations exists: ' + (typeof window.translations !== 'undefined'));
      
      if (window.translations) {
        debugLog('Languages: ' + Object.keys(window.translations).join(', '));
        debugLog('FR keys count: ' + Object.keys(window.translations.fr || {}).length);
        debugLog('EN keys count: ' + Object.keys(window.translations.en || {}).length);
      }
      
      debugLog('lang-toggle button: ' + (document.getElementById('lang-toggle') ? 'FOUND' : 'NOT FOUND'));
      debugLog('Elements with data-i18n: ' + document.querySelectorAll('[data-i18n]').length);
    }

    // Mini I18n module for testing
    let currentLang = 'fr';
    
    const toggle = document.getElementById('lang-toggle');
    if (toggle) {
      toggle.addEventListener('click', () => {
        currentLang = currentLang === 'fr' ? 'en' : 'fr';
        debugLog('Switching to: ' + currentLang);
        updateContent();
        toggle.textContent = currentLang === 'fr' ? 'Switch to EN' : 'Passer en FR';
      });
    }

    function updateContent() {
      if (!window.translations || !window.translations[currentLang]) {
        debugLog('ERROR: Translations not available for ' + currentLang);
        return;
      }

      const elements = document.querySelectorAll('[data-i18n]');
      debugLog('Updating ' + elements.length + ' elements...');
      
      let updated = 0;
      elements.forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = window.translations[currentLang][key];
        
        if (translation) {
          element.textContent = translation;
          updated++;
        } else {
          debugLog('MISSING: ' + key);
        }
      });
      
      debugLog('Updated: ' + updated + '/' + elements.length);
    }

    // Auto check on load
    window.addEventListener('load', () => {
      setTimeout(() => {
        checkSystem();
        updateContent();
      }, 100);
    });
  </script>
</body>
</html>
